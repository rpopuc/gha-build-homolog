name: Deploy automation on develop branch

on:
  push:
    branches:
      - develop

concurrency:
  group: build-homolog

jobs:
  update-branch:
    name: Update Develop
    runs-on: ubuntu-latest
    steps:
      - name: Checkout do repositÃ³rio
        uses: actions/checkout@v2
        with:
          fetch-depth: 0

      - name: Rebase branch
        run: |
          git fetch --all
          git checkout homolog
          lista_branches=$(cat homolog-branches)
          set +e
          output=`bash .github/support/deploy-environment.sh "$lista_branches"`
          result=$?
          echo "error=$output" >> $GITHUB_OUTPUT
          exit $result
